var $jscomp$templatelit$8=['\n    \x3cdiv class\x3d"ui"\n      onclick\x3d"dispatch(\'VALIDATE_SNAPSHOT\')"\x3e\x3c/div\x3e\n  '];$jscomp$templatelit$8.raw=['\n    \x3cdiv class\x3d"ui"\n      onclick\x3d"dispatch(\'VALIDATE_SNAPSHOT\')"\x3e\x3c/div\x3e\n  '];var $jscomp$templatelit$7=['\n    \x3cimg class\x3d"ui"\n      style\x3d"opacity: .5"\n      src\x3d"','"\x3e\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'PLAY_AGAIN\')"\x3e\n      \x3cdiv\x3e',"%\x3c/div\x3e\n    \x3c/div\x3e\n  "];
$jscomp$templatelit$7.raw=['\n    \x3cimg class\x3d"ui"\n      style\x3d"opacity: .5"\n      src\x3d"','"\x3e\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'PLAY_AGAIN\')"\x3e\n      \x3cdiv\x3e',"%\x3c/div\x3e\n    \x3c/div\x3e\n  "];var $jscomp$templatelit$6=['\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'START_LEVEL\')"\x3e\n      \x3cdiv\x3eFind this moment.\x3c/div\x3e\n    \x3c/div\x3e\n  '];$jscomp$templatelit$6.raw=['\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'START_LEVEL\')"\x3e\n      \x3cdiv\x3eFind this moment.\x3c/div\x3e\n    \x3c/div\x3e\n  '];
var $jscomp$templatelit$5=['\n    \x3cdiv class\x3d"ui"\n      style\x3d"background-color: #000"\x3e\n      \x3cdiv style\x3d"\n        display: flex;\n        flex-wrap: wrap;\n        max-width: 1280px;\n        max-height: 720px"\x3e\n      ','\n      \x3cdiv class\x3d"action"\n        style\x3d"padding: .5rem"\n        onclick\x3d"dispatch(\'PLAY_LEVEL\')"\x3enext\x3c/div\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n  '];
$jscomp$templatelit$5.raw=['\n    \x3cdiv class\x3d"ui"\n      style\x3d"background-color: #000"\x3e\n      \x3cdiv style\x3d"\n        display: flex;\n        flex-wrap: wrap;\n        max-width: 1280px;\n        max-height: 720px"\x3e\n      ','\n      \x3cdiv class\x3d"action"\n        style\x3d"padding: .5rem"\n        onclick\x3d"dispatch(\'PLAY_LEVEL\')"\x3enext\x3c/div\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n  '];
var $jscomp$templatelit$4=['\n     \x3cdiv class\x3d"box"\n       style\x3d"padding: .5rem"\x3e\n       ',"%\x3c/div\x3e\n  "];$jscomp$templatelit$4.raw=['\n     \x3cdiv class\x3d"box"\n       style\x3d"padding: .5rem"\x3e\n       ',"%\x3c/div\x3e\n  "];var $jscomp$templatelit$3=['\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'PLAY_NOW\')"\x3e\n      \x3cdiv\x3eA moment lost in time.\x3c/div\x3e\n    \x3c/div\x3e\n  '];$jscomp$templatelit$3.raw=['\n    \x3cdiv class\x3d"ui action"\n      onclick\x3d"dispatch(\'PLAY_NOW\')"\x3e\n      \x3cdiv\x3eA moment lost in time.\x3c/div\x3e\n    \x3c/div\x3e\n  '];
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var c,b=[];!(c=a.next()).done;)b.push(c.value);return b};
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var c=function(){};c.prototype=a;return new c};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(b){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,c){a.prototype=$jscomp.objectCreate(c.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;b(a,c)}else for(b in c)if("prototype"!=b)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(c,b);f&&Object.defineProperty(a,b,f)}else a[b]=c[b];a.superClass_=c.prototype};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,f){if(c){b=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var h=a[f];h in b||(b[h]={});b=b[h]}a=a[a.length-1];f=b[a];c=c(f);c!=f&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function b(a){var d=Object[a];d&&(Object[a]=function(a){c(a);return d(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(E){return!1}}())return a;var f="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var h=0,m=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};m.prototype.set=function(a,d){c(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=d;return this};m.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};m.prototype.has=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};m.prototype.delete=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return m},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),b=new a($jscomp.makeIterator([[d,"s"]]));if("s"!=b.get(d)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var c=b.entries(),f=c.next();if(f.done||f.value[0]!=d||"s"!=f.value[1])return!1;f=c.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!c.next().done?!1:!0}catch(C){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var c=new WeakMap,b=function(a){this.data_={};this.head_=m();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};b.prototype.set=function(a,b){var d=f(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};b.prototype.delete=
function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=m();this.size=0};b.prototype.has=function(a){return!!f(this,a).entry};b.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};b.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};b.prototype.keys=function(){return h(this,function(a){return a.key})};b.prototype.values=function(){return h(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var f=function(a,b){var d=b&&typeof b;"object"==d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++p,c.set(b,d)):d="p_"+b;var f=a.data_[d];if(f&&$jscomp.owns(a.data_,d))for(a=0;a<f.length;a++){var h=
f[a];if(b!==b&&h.key!==h.key||b===h.key)return{id:d,list:f,index:a,entry:h}}return{id:d,list:f,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},m=function(){var a={};return a.previous=a.next=a.head=a},p=0;return b},"es6","es3");
$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,b){for(var c=1;c<arguments.length;c++){var h=arguments[c];if(h)for(var m in h)$jscomp.owns(h,m)&&(a[m]=h[m])}return a}},"es6","es3");
(function(a,c,b,f,h,m){function p(a,b){for(var e=[],g=1;g<arguments.length;++g)e[g-1]=arguments[g];g=$jscomp.makeIterator(a);var c=g.next().value,d=$jscomp.arrayFromIterator(g);return e.reduce(function(a,e){return a.concat(e,d.shift())},[c]).join("")}function d(a,b){a=void 0===a?0:a;b=void 0===b?1:b;return Math.floor(F()*(b-a+1)+a)}function v(a,b){a=void 0===a?0:a;b=void 0===b?1:b;return F()*(b-a)+a}function E(a,b,k){var e=$jscomp.makeIterator(a);a=e.next().value;e=e.next().value;k=void 0===k?1.5:
k;var g=v(0,2*Math.PI);b=v(0,b);return h.vec3.of(a+b*Math.cos(g),k,e+b*Math.sin(g))}function M(a){var b=v(-Math.PI/10,Math.PI/10),e=v(0,Math.PI/6);b=h.vec3.of(Math.cos(e)*Math.sin(b),Math.sin(e),Math.cos(e)*Math.cos(b));h.vec3.normalize(b,b);return h.vec3.transform_mat4(b,b,a)}function C(a,b){return a.reduce(function(a,e,c){return a+e*b[c]},0)}function G(a,b){var e=h.vec3.zero.slice();h.vec3.subtract(e,a,b);return Math.sqrt(C(e,e))}function H(a,b,c){var e=G(a.position,b.position);c=Math.max(0,1-e/
(Math.sqrt(c*c)/2));a=Math.abs(C(a.rotation,b.rotation));return(c+a)/2}function I(a,b){a=void 0===a?0:a;return Math.floor(Math.random()*((void 0===b?1:b)-a+1)+a)}function J(){var a=K[I(0,K.length-1)],b=l.createOscillator();b.type="sine";b.frequency.value=a;a=l.createGain();a.gain.setTargetAtTime(1,l.currentTime,.1);a.gain.setTargetAtTime(0,l.currentTime+1,.1);b.connect(a);a.connect(y);b.start();b.stop(l.currentTime+10);setTimeout(J,2E3+I(0,1E4))}function L(a,b){a=m.hsl_to_rgb(a,.7,b);return m.rgb_to_hex(a)}
function N(e,g){var k=new a.Game({width:window.innerWidth,height:window.innerHeight,clear_color:"#eeeeee",far:1E3});k.camera.components.delete(b.Move);k.camera.add_component(new z({keyboard_controlled:!1,mouse_controlled:!1,move_speed:25,rotate_speed:.5}));g=L(g,.6);var r=new c.Plane;r.get_component(b.Transform).scale=[1E3,1,1E3];r.get_component(b.Render).set({material:f.basic,color:g});k.add(r);for(r=0;r<Math.pow(e,2)+1;r++)O(r,g).forEach(function(a){D.push(a);k.add(a)});k.camera.get_component(b.Transform).position=
E([0,0],1E3/3);k.camera.get_component(b.Transform).look_at(D[d(0,D.length-1)].get_component(b.Transform).position);k.camera.get_component(b.Transform).look_at(M(k.camera.get_component(b.Transform).matrix));k.on("afterrender",function w(){k.off("afterrender",w);var a={snapshot:k.canvas.toDataURL(),position:k.camera.get_component(b.Transform).position,rotation:k.camera.get_component(b.Transform).rotation};window.dispatch("SNAPSHOT_TAKEN",a);k.stop()});return k}function P(a,c,k){a.camera.get_component(b.Transform).set({position:[0,
1.74,0],rotation:h.quat.create()});a.camera.get_component(z).keyboard_controlled=!0;a.camera.get_component(z).mouse_controlled=!0;for(var e=$jscomp.makeIterator(a.entities),g=e.next();!g.done;g=e.next())g.value.get_component(b.Render).color="#000000";a.start();a.on("afterrender",function(){for(var e=H(k,a.camera.get_component(b.Transform),1E3),g=$jscomp.makeIterator(a.entities),d=g.next();!d.done;d=g.next())d.value.get_component(b.Render).color=L(c,.6*e/2)})}function u(a){for(var b=[],e=0;e<arguments.length;++e)b[e-
0]=arguments[e];return Object.assign.apply(Object,[].concat([{}],$jscomp.arrayFromIterable(b)))}function Q(a){return p($jscomp$templatelit$4,Math.floor(100*a))}var F=function(){var a=19870603;return function(){a=16807*a%2147483647;return(a-1)/2147483646}}(),O=function(a,g){var e=[],h=Math.cos(a*Math.PI),l=Math.cos(a*Math.PI),w=75+100*Math.sin(a*Math.PI/6);switch(d(0,2)){case 0:case 1:for(var x=d(0,2);x--;){var t=d(5,80),n=d(5,80),m=new c.Box;m.get_component(b.Render).set({material:f.basic,color:g});
m.get_component(b.Transform).set({position:[h*w+n,t/2,20*l*a],scale:[n,t,d(5,80)]});e.push(m)}break;case 2:x=new c.Sphere,n=new c.Box,t=d(12,17),n.get_component(b.Transform).set({position:[h*w,t/2,20*l*a],scale:[1,t,1]}),n.get_component(b.Render).set({material:f.basic,color:g}),e.push(n),n=d(2,7),x.get_component(b.Transform).set({position:[h*w,t,20*l*a],scale:[n,n,n]}),x.get_component(b.Render).set({material:f.basic,color:g}),e.push(x)}return e},l=new AudioContext,K=[220,246.942,261.626,293.665,329.628,
349.228,415.305,440],y=l.createBiquadFilter();y.type="lowpass";y.frequency.value=100;y.Q.value=10;var A=l.createConvolver();A.buffer=function(a,b){a*=l.sampleRate;for(var c=l.createBuffer(2,a,l.sampleRate),e=c.getChannelData(0),d=c.getChannelData(1),g=0;g<a;g++)e[g]=(2*Math.random()-1)*Math.pow(1-g/a,b),d[g]=(2*Math.random()-1)*Math.pow(1-g/a,b);return c}(10,10);y.connect(A);A.connect(l.destination);var z=function(a){a=b.Move.call(this,a)||this;a.traveled=0;a.footstep_every=15;return a};$jscomp.inherits(z,
b.Move);z.prototype.handle_keys=function(a,c){var e=this.entity.get_component(b.Transform),d=e.position;b.Move.prototype.handle_keys.call(this,a,c);this.traveled+=G(d,e.position);this.traveled>this.footstep_every&&(this.traveled%=this.footstep_every,e=void 0,e=void 0===e?50:e,a=l.createOscillator(),a.frequency.value=e,c=l.createOscillator(),c.frequency.value=e-20,e=l.createGain(),e.gain.value=1.5,e.gain.setTargetAtTime(0,l.currentTime+.005,.01),c.connect(e),a.connect(e),e.connect(l.destination),c.start(),
a.start(),e=l.currentTime+.1,c.stop(e),a.stop(e))};var D=[],R={scene:"SCENE_TITLE",level:null,hue:0,target:null,results:[]},q=function(a){function b(){for(var a=$jscomp.makeIterator(e),b=a.next();!b.done;b=a.next()){var c=$jscomp.makeIterator(b.value);b=c.next().value;c=c.next().value;c=c();c!==d.get(b)&&(d.set(b,c),b.innerHTML=c)}}var c=a(),e=new Map,d=new Map;return{attach:function(a,c){e.set(c,a);b()},connect:function(a){return function(b){for(var e=[],d=0;d<arguments.length;++d)e[d-0]=arguments[d];
return a.apply(null,[].concat([c],$jscomp.arrayFromIterable(e)))}},dispatch:function(e,d){for(var g=[],f=1;f<arguments.length;++f)g[f-1]=arguments[f];c=a(c,e,g);b()}}}(function(a){return function(b,c,e){console.group(c);console.log("Previous State",b);console.log("Action Arguments",e);b=a(b,c,e);console.log("Next State",b);console.groupEnd();return b}}(function(a,c,d){a=void 0===a?R:a;switch(c){case "INIT":return J(),u(a,{scene:"SCENE_TITLE"});case "PLAY_NOW":case "PLAY_LEVEL":return c=v(0,1),d=N(a.results.length+
1,c),u(a,{scene:"SCENE_FIND",level:d,hue:c});case "SNAPSHOT_TAKEN":return c=$jscomp.makeIterator(d).next().value,u(a,{target:c});case "START_LEVEL":return c=a,P(c.level,c.hue,c.target),u(a,{scene:"SCENE_PLAY"});case "VALIDATE_SNAPSHOT":var e=a;c=e.level;d=e.target;e=e.results;c.stop();c=H(d,c.camera.get_component(b.Transform),1E3);return u(a,{scene:"SCENE_SCORE",results:[].concat($jscomp.arrayFromIterable(e),[c])});case "PLAY_AGAIN":return u(a,{scene:"SCENE_LEVELS",level:null});default:return a}}));
A=q.attach;var B=q.connect;q=q.dispatch;q("INIT");window.dispatch=q;q=B(function(a){return p($jscomp$templatelit$5,a.results.map(Q))});var S=B(function(a){var b=a.results;return p($jscomp$templatelit$7,a.target.snapshot,Math.floor(100*b[b.length-1]))}),T={SCENE_TITLE:function(){return p($jscomp$templatelit$3)},SCENE_LEVELS:q,SCENE_FIND:function(){return p($jscomp$templatelit$6)},SCENE_SCORE:S,SCENE_PLAY:function(){return p($jscomp$templatelit$8)}};B=B(function(a){return(a=T[a.scene])?a():""});A(B,
document.querySelector("#root"))})(core,shapes,components,materials,math,utils);
